---
title: "Laboratorio4"
author: "Juan Barillas"
date: "31/8/2020"
output: html_document
---

```{r}
library(tidyverse)
library(readr)
library(dplyr)
library(igraph)
library(ggplot2)
library(magrittr)

data <- read_csv("tabla_completa.csv", locale = readr::locale(encoding = "latin1"))
data <- data %>%
  separate(CLIENTE, c("CLIENTE","MOTIVO"), sep = "\\/ |\\|\\|\\|")

data$MOTIVO <- tolower(data$MOTIVO)
data
```

Debemos invertir en la contratacion de mas personal?
Tenemos que calcular cuantas entregas realizan los empleados y ver si es necesario reducirlo contratando m[as gente.]

```{r}
entregas_piloto <- data %>%
  group_by(MES) %>%
  count(PILOTO)
mensuales = aggregate(entregas_piloto$n, by=list(MES=entregas_piloto$MES), FUN=sum)
mensuales %>%
  mutate(AVG = x/9)
barplot(mensuales$x, names.arg = mensuales$MES, las=2, cex.names = 0.5, space = 1, main = "Viajes realizados por mes")
count(PILOTO)
```
Los pilotos tienen entre 21 y 23 entregas al mes por lo que hacen 1 entrega por d[ia en un mes lo que no es un numero alto y no se necesita contratar a mas personas.]

## Debemos invertir en la compra de mas vehiculos de distribuci[on?] Cu[antos y de que tipo?]

```{r}
n_entregas <- data %>%
  count(UNIDAD)

library(plotrix)
slices <- c(1211, 605,364)
lbls <- c("Camion Grande", "Camion Peque;o", "Panel")
pct <- round(slices/sum(slices)*100)
lbls <- paste(lbls,pct)
lbls <- paste(lbls,"%",sep="")
pie(slices,labels=lbls,col=rainbow(length(lbls)), main="Cantidad de viajes realizados por tipo de vehiculo")

producto_camion <- aggregate(data$CANTIDAD, by=list(UNIDAD=data$UNIDAD), FUN=sum)
barplot(producto_camion$x, names.arg = producto_camion$UNIDAD, las=2, cex.names = 0.65, space = 0.5, main = "Cantidad de producto movido por los distintos camiones")
grandes <- data %>%
  filter(UNIDAD == "Camion Grande")

chiquito <- data %>%
  filter(UNIDAD == "Camion Pequeño")

panel <- data %>%
  filter(UNIDAD == "Panel")


#Promedio de cantidad de producto entregada
cat("Promedio de cantidad:", mean(data$CANTIDAD))

prueba <- cbind(n_entregas, cantidad=producto_camion$x)
prueba %>%
  mutate(avg = cantidad/n)

#Numero de entregas por mes de camiones grandes
data %>%
  filter(UNIDAD == "Camion Grande") %>%
  group_by(MES) %>% 
  count(MES)
#Numero de entregas por mes de camiones pequeños
data %>%
  filter(UNIDAD == "Camion Pequeño") %>%
  group_by(MES) %>% 
  count(MES)
#Numero de entregas por mes de paneles
data %>%
  filter(UNIDAD == "Panel") %>%
  group_by(MES) %>% 
  count(MES)

```
## Las tarifas actuales son aceptables por el cliente?

```{r}
data %>% 
  mutate(PrecioPorUnidad=Q/CANTIDAD)

aggregate(entregas_piloto$n, by=list(MES=entregas_piloto$MES), FUN=sum)
cat("Precio por unidad", (data$Q/data$CANTIDAD))

```
Todas las tarifas son las mismas por producto de $0.25 y podemos ver que existen siempre pedidos regulares por lo que podemos inferir que el precio es aceptado por nuestros clientes


